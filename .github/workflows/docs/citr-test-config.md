# CITR Environment Configuration

## Overview

This document outlines the configuration settings for the CITR (Continuous Integration Test & Release) environment used in our workflows. The CITR environment is designed to facilitate automated testing and deployment processes.

There are several test suites that are run in the CITR environment, each with its own configuration settings. The main test suites include:

| Test Suite  |             Name              |                                      Description                                       | Automated |
|-------------|-------------------------------|----------------------------------------------------------------------------------------|-----------|
| MATS        | Minimal Acceptable Test Suite | Basic checks against main branch when changes are made                                 | X         |
| XTS         | Extended Test Suite           | More comprehensive tests run on a scheduled basis                                      | X         |
| SDCT        | Single Day Canonical Tests    | More comprehensive tests that focus on load, throughput, etc                           | X         |
| SDLT        | Single Day Longevity Tests    | Longevity tests to ensure stability over extended periods                              | X         |
| SDPT        | Single Day Performance Tests  | Performance-focused tests to evaluate system responsiveness                            | X         |
| MDLT        | Multi Day Longevity Tests     | Extended longevity tests over multiple days                                            |           |
| Shortgevity | Short Longevity Tests         | Short-term longevity tests for checking performance against a mainnet-like environment |           |

## MATS

### Environment

- MATS runs inside of self-hosted github runners on every *push* to the **default branch** (`main`).
- MATS is expected to complete within 30 minutes of the test suite starting.
- MATS has an equivalent set of tests that run in PRs against feature branches triggered on *pull_request* events.

### Workflows

- MATS is triggered by the [Node: Build Application](/.github/workflows/node-flow-build-application.yaml) workflow.
- The PR Check equivalent checks are triggered by the [Node: PR Checks](/.github/workflows/node-flow-pull-request-checks.yaml) workflow.
- MATS Dry-Run is triggered manually via the [[CITR] MATS Dry Run](/.github/workflows/flow-dry-run-mats-suite.yaml) workflow.

### Included Tests

|                Test Name                 |                                              Workflow                                               |                                                       Required Parameters                                                       |                                               Required Workflow Secrets                                               | Precursor Steps |
|------------------------------------------|-----------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|-----------------|
| MATS - Compile Application Code          | [ZXC: Compile Application Code](/.github/workflows/zxc-compile-application-code.yaml)               | `ref: <commit-sha>`                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                |                 |
| MATS - Dependency (Module Info)          | [ZXC: Dependency Module Check](/.github/workflows/zxc-dependency-module-check.yaml)                 | `ref: <commit-sha>`                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - Spotless Check                    | [ZXC: Spotless Check](/.github/workflows/zxc-spotless-check.yaml)                                   | `ref: <commit-sha>`                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - Unit Tests                        | [ZXC: Execute Unit Tests](/.github/workflows/zxc-execute-unit-tests.yaml)                           | `ref: <commit-sha>`                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`<br/>`codacy-project-token`<br/>`codecov-token` | build           |
| MATS - Integration Tests                 | [ZXC: Execute Integration Tests](/.github/workflows/zxc-execute-integration-tests.yaml)             | `ref: <commit-sha>`<br/>`enable-network-log-capture: true`                                                                      | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Misc)                 | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-misc: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS`           | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Misc Records)         | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-misc-records: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS`   | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Crypto)               | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-crypto: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS`         | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Simple Fees)          | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-simplefees: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS`     | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (ISS)                  | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-iss: true`<br/>`enable-network-log-capture: true`                                    | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Token)                | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-token: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS`          | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Smart Contract)       | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-smart-contract: true`<br/>`enable-network-log-capture: true`<br/>`mats-suffix: MATS` | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Restart)              | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-restart: true`<br/>`enable-network-log-capture: true`                                | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - HAPI Tests (Node Death Reconnect) | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                           | `ref: <commit-sha>`<br/>`enable-hapi-tests-nd-reconnect: true`<br/>`enable-network-log-capture: true`                           | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - Otter Tests                       | [ZXC: Execute Otter Tests](/.github/workflows/zxc-execute-otter-tests.yaml)                         | `ref: <commit-sha>`<br/>`enable-fast-otter-tests: true`<br/>`enable-network-log-capture: true`                                  | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                | build           |
| MATS - Snyk Checks                       | [ZXC: Snyk Scan](/.github/workflows/zxc-snyk-scan.yaml)                                             | `ref: <commit-sha>`                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`<br/>`snyk-token`                               | build           |
| MATS - Gradle Determinism                | [ZXC: Verify Gradle Build Determinism](/.github/workflows/zxc-verify-gradle-build-determinism.yaml) | `ref: <commit-sha>`                                                                                                             | `gradle-cache-username`<br/>`gradle-cache-password`                                                                   | build           |
| MATS - Docker Determinism                | [ZXC: Verify Docker Build Determinism](/.github/workflows/zxc-verify-docker-build-determinism.yaml) | `ref: <commit-sha>`                                                                                                             | `gradle-cache-username`<br/>`gradle-cache-password`                                                                   | build           |

## XTS

### Environment

- XTS runs inside of self-hosted github runners every 3 hours on the **default branch** (`main`).
- XTS is expected to complete within 3 hours of the test suite starting.
- XTS has a dry-run equivalent that can be run against any PR, tag, or branch.

### Workflows

- XTS is triggered by the [ZXCron: [CITR] Extended Test Suite](/.github/workflows/zxcron-extended-test-suite.yaml) workflow.
- XTS Dry Run is triggered manually via the [[CITR] XTS Dry Run](/.github/workflows/flow-dry-run-extended-test-suite.yaml) workflow.

### Included Tests

|                 Test Name                 |                                             Workflow                                              |                                                                                                                                                     Required Parameters                                                                                                                                                     |                                                                                                                Required Workflow Secrets                                                                                                                 |           Precursor Steps            |
|-------------------------------------------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
| XTS Compile Code                          | [ZXC: Compile Application Code](/.github/workflows/zxc-compile-application-code.yaml)             |                                                                                                                                                                                                                                                                                                                             | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   |                                      |
| XTS Timing Sensitive Tests                | [ZXC: Execute Timing Sensitive Tests](/.github/workflows/zxc-execute-timing-sensitive-tests.yaml) | `ref: <commit-sha>`                                                                                                                                                                                                                                                                                                         | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| XTS Time Consuming Tests                  | [ZXC: Execute Time Consuming Tests](/.github/workflows/zxc-execute-time-consuming-tests.yaml)     | `ref: <commit-sha>`                                                                                                                                                                                                                                                                                                         | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| XTS Hammer Tests                          | [ZXC: Execute Hammer Tests](/.github/workflows/zxc-execute-hammer-tests.yaml)                     | `ref: <commit-sha>`                                                                                                                                                                                                                                                                                                         | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| XTS HAPI Tests (Time Consuming)           | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                         | `enable-hapi-tests-time-consuming: true`<br/>`enable-network-log-capture: true`<br/>`ref: <commit-sha>`                                                                                                                                                                                                                     | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| XTS HAPI Tests (Block Node Communication) | [ZXC: Execute HAPI Tests](/.github/workflows/zxc-execute-hapi-tests.yaml)                         | `enable-hapi-tests-bn-communication: true`<br/>`enable-network-log-capture: true`<br/>`ref: <commit-sha>`                                                                                                                                                                                                                   | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| XTS Otter Tests                           | [ZXC: Execute Otter Tests](/.github/workflows/zxc-execute-otter-tests.yaml)                       | `enable-full-otter-tests: true`<br/>`enable-network-log-capture: true`<br/>`ref: <commit-sha>`                                                                                                                                                                                                                              | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`                                                                                                                                                                                   | Fetch XTS Candidate<br/>Compile Code |
| JRS Panel                                 | [ZXC: Regression](/.github/workflows/zxc-jrs-regression.yaml)                                     | `panel-config: configs/suites/GCP-PRCheck-Abbrev-4N.json`<br/>`ref: <commit-sha>`<br/>`branch-name: <github.head_ref or github.ref_name>`<br/>`base-branch-name: github.base_ref or ''`<br/>`slack-results-channel: regression-test`<br/>`slack-summary-channel: regression-test`<br/>`use-branch-for-slack-channel: false` | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`<br/>`jrs-ssh-user-name`<br/>`jrs-ssh-key-file`<br/>`gcp-project-number`<br/>`gcp-sa-key-contents`<br/>`slack-api-token`<br/>`grafana-agent-username`<br/>`grafana-agent-password` | Fetch XTS Candidate<br/>Compile Code |
| Hedera Node JRS Panel                     | [ZXC: Regression](/.github/workflows/zxc-jrs-regression.yaml)                                     | `panel-config: configs/services/suites/daily/GCP-Daily-Services-Abbrev-DAB-Update-4N-2C.json`<br/>`ref: <commit-sha>`<br/>`branch-name: <github.head_ref or github.ref_name>`<br/>`hedera-tests-enabled: true`<br/>`use-branch-for-slack-channel: false`                                                                    | `access-token`<br/>`gradle-cache-username`<br/>`gradle-cache-password`<br/>`jrs-ssh-user-name`<br/>`jrs-ssh-key-file`<br/>`gcp-project-number`<br/>`gcp-sa-key-contents`<br/>`slack-api-token`<br/>`grafana-agent-username`<br/>`grafana-agent-password` | Fetch XTS Candidate<br/>Compile Code |
| SDK TCK Regression Panel                  | [ZXC: TCK Regression](/.github/workflows/zxc-tck-regression.yaml)                                 | `ref: <commit-sha>`<br/>`solo-version: vars.CITR_SOLO_VERSION`                                                                                                                                                                                                                                                              | `access-token`<br/>`slack-tck-report-webhook`<br/>`slack-detailed-report-webhook`                                                                                                                                                                        | Fetch XTS Candidate<br/>Compile Code |
| Mirror Node Regression Panel              | [ZXC: Mirror Node Regression](/.github/workflows/zxc-mirror-node-regression.yaml)                 | `ref: <commit-sha>`<br/>`solo-version: vars.CITR_SOLO_VERSION`<br/>`helm-release-name: mirror or mirror-1`                                                                                                                                                                                                                  | `access-token`<br/>`slack-detailed-report-webhook`                                                                                                                                                                                                       | Fetch XTS Candidate<br/>Compile Code |
| JSON-RPC Relay Regression Panel           | [ZXC: JSON-RPC Relay Regression](/.github/workflows/zxc-json-rpc-relay-regression.yaml)           | `ref: <commit-sha>`<br/>`solo-version: vars.CITR_SOLO_VERSION`                                                                                                                                                                                                                                                              | `access-token`<br/>`slack-detailed-report-webhook`                                                                                                                                                                                                       | Fetch XTS Candidate<br/>Compile Code |
| Block Node Regression Panel               | [ZXC: Block Node Explorer Regression](/.github/workflows/zxc-block-node-regression.yaml)          | `ref: <commit-sha>`<br/>`solo-version: vars.CITR_SOLO_VERSION`                                                                                                                                                                                                                                                              | `access-token`<br/>`slack-detailed-report-webhook`                                                                                                                                                                                                       | Fetch XTS Candidate<br/>Compile Code |

## SDCT

## SDLT

## SDPT

## MDLT

## Shortgevity
